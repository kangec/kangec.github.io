---
title: 多线程交替打印
date: 2020-10-13 20:50:40
permalink: /pages/d362b2/
categories: 
  - 专栏
  - Java基础
tags: 
  - 
---

用两个线程，一个输出字母，一个输出数字，交替输出1A2B3C....26Z

<!-- more -->

## LockSupport.park() & LockSupport.unpark()

使用JUC包下的LockSupport，LockSupport.park()与LockSupport.unpark()都是调用Unsafe类内的本地方法，使用C或C++开发。

```java
public class Main {
    private static Thread numsThread;
    private static Thread charThread;

    public static void main(String[] args) {
        char[] nums = "123456789".toCharArray();
        char[] chars = "ABCDEFGHI".toCharArray();

        numsThread = new Thread(()-> {
            for (char num : nums) {
                System.out.print(num);
                LockSupport.unpark(charThread); // 唤醒 charThread
                LockSupport.park(); // 将自己阻塞
            }
        },"numsThread");

        charThread = new Thread(()-> {
            for (char c : chars) {
                LockSupport.park();  // 先将自己阻塞，等待charThread唤醒自己
                System.out.print(c);  // 打印
                LockSupport.unpark(numsThread); // 任务完成，唤醒numsThread
            }
        },"charThread");

        numsThread.start();
        charThread.start();
    }
}
```

## wait() & notifyAll()

使用Object.wait()和Object.notifyAll()或者Object.wait()和Object.notify()，它们的区别是notify()会随机唤醒一个线程。

```java
public class Main {
    public static void main(String[] args) {
        final Object lock = new Object();
        char[] nums = "123456789".toCharArray();
        char[] chars = "ABCDEFGHI".toCharArray();
        new Thread(() -> {
            synchronized (lock) {
                for (char num : nums) {
                    try {
                        System.out.print(num);
                        lock.notifyAll();
                        lock.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        }, "numsThread").start();

        new Thread(() -> {
            synchronized (lock) {
                for (char c : chars) {
                    try {
                        System.out.print(c);  // 打印
                        lock.notifyAll();
                        lock.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        }, "charThread").start();
    }
}
```