(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{451:function(t,a,s){"use strict";s.r(a);var n=s(20),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("数据的校验是交互式网站一个不可或缺的功能，前端的js校验可以涵盖大部分的校验职责，如用户名唯一性，生日格式，邮箱格式校验等等常用的校验。但是为了避免用户绕过浏览器，使用http工具直接向后端请求一些违法数据，服务端的数据校验也是必要的，可以防止脏数据落到数据库中，如果数据库中出现一个非法的邮箱格式，也会让运维人员头疼不已。本文将要介绍使用validation来对数据进行校验。")]),t._v(" "),s("h2",{attrs:{id:"hibernate-validation与spring-validation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hibernate-validation与spring-validation"}},[t._v("#")]),t._v(" Hibernate Validation与Spring Validation")]),t._v(" "),s("p",[t._v("JSR303是一项标准,JSR|349是其的升级版本，添加了一些新特性，他们规定一些校验规范即校验注解，如**@Null**，"),s("strong",[t._v("@NotNull")]),t._v("，"),s("strong",[t._v("@Pattern")]),t._v("，位于"),s("code",[t._v("javax.validation.constraints")]),t._v("包下，只提供规范不提供实现。")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Hibernate Validation")]),t._v("是对这个规范的实现，它提供了相应的实现，并增加了一些其他校验注解，如**@Email**，"),s("strong",[t._v("@Length")]),t._v("，"),s("strong",[t._v("@Range")]),t._v("等等，他们位于"),s("code",[t._v("org.hibernate.validator.constraints")]),t._v("包下。")]),t._v(" "),s("li",[s("strong",[t._v("Spring Validation")]),t._v("是Spring为了给开发者提供便捷对"),s("strong",[t._v("Hibernate Validation")]),t._v("进行了二次封装。显示校验validated bean时，可以使用spring validation或者hibernate validation，而spring validation另一个特性，便是其在springmvc模块中添加了"),s("strong",[t._v("自动校验")]),t._v("，并将"),s("strong",[t._v("校验信息封装进了特定的类中")]),t._v("。这无疑便捷了我们的web开发。本文主要介绍在springmvc中自动校验的机制。")])]),t._v(" "),s("h2",{attrs:{id:"常用注解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用注解"}},[t._v("#")]),t._v(" 常用注解")]),t._v(" "),s("p",[t._v("在真正使用之前，我们需要大致了解校验框架所提供的常用注解。")]),t._v(" "),s("h3",{attrs:{id:"jsr提供的校验注解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jsr提供的校验注解"}},[t._v("#")]),t._v(" JSR提供的校验注解")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("注解")]),t._v(" "),s("th",[t._v("作用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("@Null")]),t._v(" "),s("td",[t._v("被注释的元素必须为 null")])]),t._v(" "),s("tr",[s("td",[t._v("@NotNull")]),t._v(" "),s("td",[t._v("被注释的元素必须不为 null")])]),t._v(" "),s("tr",[s("td",[t._v("@AssertTrue")]),t._v(" "),s("td",[t._v("被注释的元素必须为 true")])]),t._v(" "),s("tr",[s("td",[t._v("@AssertFalse")]),t._v(" "),s("td",[t._v("被注释的元素必须为 false")])]),t._v(" "),s("tr",[s("td",[t._v("@Min(value)")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个数字，其值必须大于等于指定的最小值")])]),t._v(" "),s("tr",[s("td",[t._v("@Max(value)")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个数字，其值必须小于等于指定的最大值")])]),t._v(" "),s("tr",[s("td",[t._v("@DecimalMin(value)")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个数字，其值必须大于等于指定的最小值")])]),t._v(" "),s("tr",[s("td",[t._v("@DecimalMax(value)")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个数字，其值必须小于等于指定的最大值")])]),t._v(" "),s("tr",[s("td",[t._v("@Size(max=, min=)")]),t._v(" "),s("td",[t._v("被注释的元素的大小必须在指定的范围内")])]),t._v(" "),s("tr",[s("td",[t._v("@Digits (integer, fraction)")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个数字，其值必须在可接受的范围内")])]),t._v(" "),s("tr",[s("td",[t._v("@Past")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个过去的日期")])]),t._v(" "),s("tr",[s("td",[t._v("@Future")]),t._v(" "),s("td",[t._v("被注释的元素必须是一个将来的日期")])]),t._v(" "),s("tr",[s("td",[t._v("@Pattern(regex=,flag=)")]),t._v(" "),s("td",[t._v("被注释的元素必须符合指定的正则表达式")])])])]),t._v(" "),s("h3",{attrs:{id:"hibernate-validator提供的校验注解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hibernate-validator提供的校验注解"}},[t._v("#")]),t._v(" Hibernate Validator提供的校验注解")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("注解")]),t._v(" "),s("th",[t._v("作用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("@NotBlank(message =)")]),t._v(" "),s("td",[t._v("验证字符串非null，且长度必须大于0")])]),t._v(" "),s("tr",[s("td",[t._v("@Email")]),t._v(" "),s("td",[t._v("被注释的元素必须是电子邮箱地址")])]),t._v(" "),s("tr",[s("td",[t._v("@Length(min=,max=)")]),t._v(" "),s("td",[t._v("被注释的字符串的大小必须在指定的范围内")])]),t._v(" "),s("tr",[s("td",[t._v("@NotEmpty")]),t._v(" "),s("td",[t._v("被注释的字符串的必须非空")])]),t._v(" "),s("tr",[s("td",[t._v("@Range(min=,max=,message=)")]),t._v(" "),s("td",[t._v("被注释的元素必须在合适的范围内")])])])]),t._v(" "),s("h2",{attrs:{id:"实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[t._v("#")]),t._v(" 实战")]),t._v(" "),s("h3",{attrs:{id:"引入依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引入依赖"}},[t._v("#")]),t._v(" 引入依赖")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-web"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-starter-validation"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("注意："),s("strong",[t._v("Spring Boot 2.3之后Hibernate Validator从spring-boot-starter-web中移除，需要添加spring-boot-starter-validation")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"创建实体类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建实体类"}},[t._v("#")]),t._v(" 创建实体类")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotBlank")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotBlank")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Min")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Age must be greater than zero!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("regexp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1([34578])\\\\d{9}$"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Wrong format of phone number."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@NotBlank")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" phone"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Email")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//省略 getter and setter")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("h3",{attrs:{id:"在controller中校验数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在controller中校验数据"}},[t._v("#")]),t._v(" 在Controller中校验数据")]),t._v(" "),s("p",[t._v("springmvc为我们提供了自动封装表单参数的功能，一个添加了参数校验的典型controller如下所示。")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);